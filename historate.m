function [mr1, mr, zzo] = historate(cat, spk, corr, win)%function [mr, zzo] = historate(cat, spk, corr, win)if nargin >= 3	c1 = find(corr == 1);	cat = cat(c1);	spk = spk(:, c1);else	c1 = [1:length(cat)];endif nargin < 4	errorendspk = double(spk);cats = unique(cat);num_cat = length(cats);for i = 1:num_cat	zz{i} = find(cat == cats(i));	zzo{i} = c1(zz{i});	mr{i} = meanrate(spk(:, zz{i}), win(1), win(2));	mr1(i) = mean(mr{i});end