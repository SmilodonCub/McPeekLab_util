function [uplot, denmean] = uplot(vals, col, sigma)% function uplot = uplot(vals, col, sigma)[a b c d] = size(vals);m = zeros(a,c);if nargin < 3	sigma = 10;endif b==0	uplot=plot(0,0);    denmean = nan;	returnendvals = double(vals);if b > 1	for i=1:c   		m(:,i) = mean(vals(:,:,i)')';	end;	if sigma > 0		m = gauss(sigma, 1000, m) * 1000;	else		m = sgauss(m, 1000);	end	if nargin == 1		uplot = plot(m);	else  		 uplot = plot(m, 'color', col);	end;else	m = vals;	if sigma > 0		m = gauss(sigma, 1000, vals(:,1,:)) * 1000;		else		m = sgauss(m, 1000);	end		if nargin == 1		uplot = plot(m);	else		uplot = plot(m, 'color', col);	end;end;denmean = m;