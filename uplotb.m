function uplot = uplot(vals, col, sigma, twin)% function uplot = uplot(vals, col, sigma, twin)% get rid of edge artifacts from density plots by cutting off edges of plot.[a b c d] = size(vals);m = zeros(a,c);if nargin < 4	twin = [20:size(spk1,1)-20];endif nargin < 3	sigma = 4;endif b==0	uplot=plot(0,0);	returnendif b > 1	for i=1:c   		m(:,i) = mean(vals(:,:,i)')';	end;	if sigma > 0		m = gauss(sigma, 1000, m) * 1000;	else		m = sgauss(m, 1000);	end	if nargin == 1		uplot = plot(m(twin));	else  		 uplot = plot(m(twin), 'color', col);	end;else	if sigma > 0		m = gauss(sigma, 1000, vals(:,1,:)) * 1000;		else		m = sgauss(m, 1000);	end		if nargin == 1		uplot = plot(m(twin));	else		uplot = plot(m(twin), 'color', col);	end;end;